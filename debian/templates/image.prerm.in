#!/bin/sh -e

version=@abiname@@localversion@
image_path=/boot/@image-stem@-$version

if [ "$1" != remove ]; then
    exit 0
fi

linux-check-removal $version

if [ -d /etc/kernel/prerm.d ]; then
    DEB_MAINT_PARAMS="$*" run-parts --report --exit-on-error --arg=$version \
	      --arg=$image_path /etc/kernel/prerm.d
fi

for extra_file in modules.dep modules.isapnpmap modules.pcimap \
		  modules.usbmap modules.parportmap \
		  modules.generic_string modules.ieee1394map \
		  modules.ieee1394map modules.pnpbiosmap \
		  modules.alias modules.ccwmap modules.inputmap \
		  modules.symbols modules.ofmap \
		  modules.seriomap modules.\*.bin \
		  modules.softdep modules.devname; do
    eval rm -f /lib/modules/$version/$extra_file
done

exit 0
